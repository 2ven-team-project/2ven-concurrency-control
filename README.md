# 2ven-concurrency-control

# 동시성 제어
## 1. 팀원 소개

| 역할   | 이름   | 담당 업무                                                                                 |
|--------|--------|-------------------------------------------------------------------------------------------|
| 팀장   | 장민우 | (업무 추가 여기)                                                             |
| 팀원   | 심윤호 | (업무 추가 여기)                                  |
| 팀원   | 서민기 | (업무 추가 여기)                      |
| 팀원   | 고의정 | (업무 추가 여기)                |
| 팀원   | 박정완 | (업무 추가 여기)                                                                   |

---


## 2. 주요 백엔드 사용 기술

<div align="center">
    <img src="https://github.com/user-attachments/assets/38b58c0d-ec0d-42a1-88aa-b516ad1b1a9b"/>
</div>

- **Spring Boot**: 애플리케이션의 주요 서버 사이드 프레임워크로 사용됩니다.
- **JPA (Java Persistence API)**: 데이터베이스와의 상호작용을 관리하는 데 사용됩니다.
- **MySQL**: 데이터 저장 및 관리에 사용되는 관계형 데이터베이스입니다.
- **JWT (JSON Web Token)**: 사용자 인증 및 보안 관리를 위해 사용됩니다.

## 3. 기능 소개


## 4. 트러블 슈팅

### 문제 해결: 쿠폰 발급 오류

1. **문제 확인**:
   - `Lock`을 적용했지만 쿠폰 발급이 정상적으로 이루어지지 않는 오류 발생.
   - 분석 결과, 짧은 시간 안에 요청이 몰리고 충돌이 빈번하게 발생하는 구조임을 확인.

2. **초기 구현 방식**:
   - 기존 `Lock` 로직은 DB를 조회하고 컬럼 값을 개별적으로 수정하는 방식으로 요청 처리.

3. **비관적 락(Pessimistic Lock) 적용**:
   - `LockModeType`을 `PESSIMISTIC_WRITE`로 변경하여 비관적 락을 설정.
   - DB 조회 시점에 락을 걸어 충돌 방지.
   - 결과: 쿠폰 발급이 정상적으로 처리되었으나 발급 순서가 보장되지 않는 문제가 발생(스핀 락 때문).

4. **Redisson 활용**:
   - Redisson의 `pub/sub` 구조를 사용하여 락 구현.
   - 요청 처리 순서를 보장하는 방식으로 개선.

5. **최종 결과**:
   - 쿠폰 발급 오류를 해결하고, 정상 처리와 발급 순서 보장을 모두 달성.





## 와이어 프레임
<img src="images/wireframe1.png"/>
<img src="images/wireframe2.png"/>

## 4. ERD 다이어그램
<img src="images/erd.png"/>

